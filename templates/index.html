<!DOCTYPE html>
<html>
<head>
    <title>Network Analyzer</title>
</head>
<body>
    <h1>Network Analyzer</h1>
    
    <form action="/capture_packets" method="get">
        <button type="submit">Analyzer Network</button>
    </form>
    
    {% if message %}
    <p>{{ message }}</p>
    {% endif %}
    
    {% if device_stats %}
    <h2>Device Statistics</h2>
    <table>
        <tr>
            <th>IP Address</th>
            <th>Sent Packets</th>
            <th>Received Packets</th>
        </tr>
        {% for ip, stats in device_stats.items() %}
        <tr>
            <td>{{ ip }}</td>
            <td>{{ stats.sent }}</td>
            <td>{{ stats.received }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    
    {% if malicious_results %}
    <h2>Malicious Packets</h2>
    <ul>
        {% for result in malicious_results %}
        <li>{{ result.summary }} - {{ result.src_ip }} -> {{ result.dst_ip }} (src_port: {{ result.src_port }}, dst_port: {{ result.dst_port }}, flags: {{ result.tcp_flags }})</li>
        {% endfor %}
    </ul>
    {% endif %}
</body>
</html>
